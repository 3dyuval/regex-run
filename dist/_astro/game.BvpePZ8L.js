import{d as M,j as C,w as l,a,b as i,c as L,i as G,F as O,r as m,h as V,o as p,t as h,l as P,e as x,m as H,f as E,g as K,n as W,p as J,q as Q}from"./vuetify.CurCXFDi.js";import{d as Z,s as $}from"./pinia.CjVBXXqQ.js";/* empty css                       */import{_ as A}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{u as ee,a as B}from"./index.CmticHEY.js";import{g as te,R as se,a as ae,d as ne}from"./regex-features.Dth4DYyE.js";/* empty css                                   */const le=M({__name:"game-board",props:{text:{},regex:{},targets:{}},setup(c,{expose:e}){e();const s=c,t=V(()=>{if(!s.text)return[];let v=[];if(s.regex)try{const o=new RegExp(s.regex,"g");let r;for(;(r=o.exec(s.text))!==null&&(v.push({start:r.index,end:r.index+r[0].length,type:"regex"}),r[0].length!==0););}catch{}const n=[];let d=0;v.sort((o,r)=>o.start-r.start);const u=[];for(const o of v)if(u.length===0)u.push({...o});else{const r=u[u.length-1];o.start<=r.end?r.end=Math.max(r.end,o.end):u.push({...o})}for(const o of u)o.start>d&&n.push({text:s.text.substring(d,o.start),highlighted:!1}),n.push({text:s.text.substring(o.start,o.end),highlighted:!0}),d=o.end;return d<s.text.length&&n.push({text:s.text.substring(d),highlighted:!1}),n.length>0?n:[{text:s.text,highlighted:!1}]}),g={props:s,highlightedText:t};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),oe={key:0,class:"highlight"},re={key:1};function ie(c,e,s,t,g,v){const n=m("v-card-text"),d=m("v-card");return p(),C(d,{class:"game-board",variant:"outlined"},{default:l(()=>[e[0]||(e[0]=a("div",{class:"window-controls"},[a("div",{class:"dot red"}),a("div",{class:"dot yellow"}),a("div",{class:"dot green"}),a("span",{class:"file-name"},"text.txt")],-1)),i(n,{class:"text-content"},{default:l(()=>[(p(!0),L(O,null,G(t.highlightedText,(u,o)=>(p(),L(O,{key:o},[u.highlighted?(p(),L("span",oe,h(u.text),1)):(p(),L("span",re,h(u.text),1))],64))),128))]),_:1})]),_:1})}const ce=A(le,[["render",ie]]),de=M({__name:"target-display",props:{targets:{},matchedTargets:{},modelValue:{},isValid:{type:Boolean},matchCount:{},streak:{}},emits:["update:modelValue","submit"],setup(c,{expose:e,emit:s}){e();const t=c,g=s,v=E(),n=E(null),d=ee();K(d,r=>{r&&v.value?.focus()}),K(()=>t.modelValue,r=>{if(!r){n.value=null;return}try{new RegExp(r),n.value=null}catch{n.value="Invalid regex syntax"}});const o={props:t,emit:g,inputRef:v,error:n,windowFocused:d,handleKeyDown:()=>{!n.value&&t.modelValue&&g("submit")}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),ue={class:"flex items-center gap-2 mb-4 text-slate-300 font-medium"},me={key:0,class:"ml-auto streak-text"},ve={class:"flex flex-wrap gap-3"},_e={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full"};function ge(c,e,s,t,g,v){const n=m("v-icon"),d=m("v-chip"),u=m("v-card-text"),o=m("v-text-field"),r=m("v-card-actions"),_=m("v-card-outlined");return p(),C(_,null,{default:l(()=>[i(u,null,{default:l(()=>[a("div",ue,[i(n,{size:"20",color:"secondary"},{default:l(()=>[...e[1]||(e[1]=[x("mdi-target",-1)])]),_:1}),e[3]||(e[3]=a("span",null,"Find these patterns",-1)),s.streak>1?(p(),L("span",me,[i(n,{size:"16",color:"warning"},{default:l(()=>[...e[2]||(e[2]=[x("mdi-lightning-bolt",-1)])]),_:1}),x(" "+h(s.streak)+"x streak ",1)])):P("",!0)]),a("div",ve,[(p(!0),L(O,null,G(s.targets,(w,f)=>(p(),C(d,{key:f,color:s.matchedTargets.includes(f)?"success":"primary",variant:s.matchedTargets.includes(f)?"flat":"outlined",class:"font-mono text-sm relative"},{default:l(()=>[i(n,{size:"16",icon:s.matchedTargets.includes(f)?"mdi-check-circle":"mdi-circle-outline",class:"mr-2"},null,8,["icon"]),a("span",{class:W({"line-through opacity-60":s.matchedTargets.includes(f)})},' "'+h(w.text)+'" ',3),s.matchedTargets.includes(f)?(p(),L("span",_e)):P("",!0)]),_:2},1032,["color","variant"]))),128))])]),_:1}),i(r,{class:"px-4 pb-4 pt-0"},{default:l(()=>[i(o,{rounded:"xl",ref:"inputRef","model-value":s.modelValue,"onUpdate:modelValue":e[0]||(e[0]=w=>t.emit("update:modelValue",w)),onKeydown:H(t.handleKeyDown,["enter"]),placeholder:"enter your regex...",variant:"solo-filled",density:"comfortable",color:"primary","base-color":"primary","hide-details":"auto","prepend-inner-icon":"mdi-console",prefix:"/",suffix:"/g","error-messages":t.error||void 0,messages:s.isValid?"All targets matched! Press Enter to continue":void 0,autofocus:"","single-line":"",flat:"",class:"regex-input"},{"append-inner":l(()=>[s.modelValue&&!t.error?(p(),C(d,{key:0,color:s.matchCount>0?"success":"default",size:"small",variant:"tonal"},{default:l(()=>[x(h(s.matchCount)+" match"+h(s.matchCount!==1?"es":""),1)]),_:1},8,["color"])):P("",!0)]),_:1},8,["model-value","error-messages","messages"])]),_:1})]),_:1})}const fe=A(de,[["render",ge]]),pe=M({__name:"level-indicator",props:{level:{},score:{}},setup(c,{expose:e}){e();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),he={class:"level-indicator"},xe={class:"level-pill"},ke={class:"level-badge"},ye={class:"badge"},we={class:"level-text"},be={class:"score-value"};function Le(c,e,s,t,g,v){const n=m("v-icon");return p(),L("div",he,[a("div",xe,[a("div",ke,[e[0]||(e[0]=a("div",{class:"glow"},null,-1)),a("div",ye,h(s.level),1)]),a("span",we,"Challenge "+h(s.level),1),e[2]||(e[2]=a("span",{class:"divider"},"|",-1)),i(n,{size:"18",color:"warning"},{default:l(()=>[...e[1]||(e[1]=[x("mdi-trophy",-1)])]),_:1}),a("span",be,h(s.score.toLocaleString()),1)])])}const Se=A(pe,[["render",Le]]),Te=M({__name:"success-modal",props:{modelValue:{type:Boolean},level:{},score:{},pointsEarned:{}},emits:["update:modelValue","nextLevel"],setup(c,{expose:e,emit:s}){e();const t=s,v={emit:t,handleNextLevel:()=>{t("update:modelValue",!1),t("nextLevel")}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),Ee={class:"icon-container"},Ve={class:"icon-main"},Ce={class:"stats-row"},Fe={class:"stat-value"},Ue={class:"stat-value-row"},Re={class:"stat-value"};function je(c,e,s,t,g,v){const n=m("v-icon"),d=m("v-card-title"),u=m("v-card-text"),o=m("v-card"),r=m("v-btn"),_=m("v-card-actions"),w=m("v-dialog");return p(),C(w,{"model-value":s.modelValue,"max-width":"400",persistent:"",class:"success-modal"},{default:l(()=>[i(o,{class:"modal-card"},{default:l(()=>[e[8]||(e[8]=a("div",{class:"glow-effect"},null,-1)),a("div",Ee,[e[1]||(e[1]=a("div",{class:"icon-bg"},null,-1)),a("div",Ve,[i(n,{size:"40",color:"white"},{default:l(()=>[...e[0]||(e[0]=[x("mdi-sparkles",-1)])]),_:1})])]),i(d,{class:"modal-title"},{default:l(()=>[...e[2]||(e[2]=[x(" Level Complete! ",-1)])]),_:1}),i(u,{class:"modal-text"},{default:l(()=>[x(" You've mastered level "+h(s.level),1)]),_:1}),a("div",Ce,[i(o,{class:"stat-card points",variant:"outlined"},{default:l(()=>[a("span",Fe,"+"+h(s.pointsEarned),1),e[3]||(e[3]=a("span",{class:"stat-label"},"points",-1))]),_:1}),i(o,{class:"stat-card total",variant:"outlined"},{default:l(()=>[a("div",Ue,[i(n,{size:"20",color:"warning"},{default:l(()=>[...e[4]||(e[4]=[x("mdi-trophy",-1)])]),_:1}),a("span",Re,h(s.score),1)]),e[5]||(e[5]=a("span",{class:"stat-label"},"total score",-1))]),_:1})]),i(_,{class:"modal-actions"},{default:l(()=>[i(r,{block:"",size:"large",class:"next-btn",onClick:t.handleNextLevel},{default:l(()=>[e[7]||(e[7]=x(" Next Level ",-1)),i(n,{class:"ml-2"},{default:l(()=>[...e[6]||(e[6]=[x("mdi-arrow-right",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}const ze=A(Te,[["render",je]]),Ne=M({__name:"regex-legend",props:{modelValue:{type:Boolean},currentLevel:{}},emits:["update:modelValue"],setup(c,{expose:e,emit:s}){e();const t=c,g=s,v=V(()=>te(t.currentLevel)),n=V(()=>new Set(v.value.map(_=>_.id))),r={props:t,emit:g,availableFeatures:v,availableIds:n,isUnlocked:_=>n.value.has(_),getUnlockLevel:_=>Math.ceil((_-2)/.8),close:()=>g("update:modelValue",!1),get REGEX_FEATURES(){return se}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),Pe={class:"header-content"},Me={class:"icon-box"},Ae={class:"header-text"},Be={class:"features-grid"},Oe={key:0,class:"locked-overlay"},De={class:"feature-header"},Ge={class:"feature-icon"},Ie={class:"feature-info"},Ke={class:"feature-meta"},qe={class:"feature-description"},Xe={class:"feature-example"};function We(c,e,s,t,g,v){const n=m("v-icon"),d=m("v-btn"),u=m("v-card-title"),o=m("v-card"),r=m("v-alert"),_=m("v-card-text"),w=m("v-dialog");return p(),C(w,{"model-value":s.modelValue,"max-width":"900",scrollable:"","onUpdate:modelValue":e[0]||(e[0]=f=>t.emit("update:modelValue",f))},{default:l(()=>[i(o,{class:"legend-card"},{default:l(()=>[i(u,{class:"legend-header"},{default:l(()=>[a("div",Pe,[a("div",Me,[i(n,{color:"white"},{default:l(()=>[...e[1]||(e[1]=[x("mdi-book-open-variant",-1)])]),_:1})]),a("div",Ae,[e[2]||(e[2]=a("h2",null,"Regex Pattern Guide",-1)),a("p",null,"Level "+h(s.currentLevel)+" - "+h(t.availableFeatures.length)+" features unlocked",1)])]),i(d,{icon:"",variant:"text",onClick:t.close},{default:l(()=>[i(n,null,{default:l(()=>[...e[3]||(e[3]=[x("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),i(_,{class:"legend-content"},{default:l(()=>[a("div",Be,[(p(!0),L(O,null,G(t.REGEX_FEATURES,f=>(p(),C(o,{key:f.id,class:W(["feature-card",{locked:!t.isUnlocked(f.id)}]),variant:"outlined"},{default:l(()=>[t.isUnlocked(f.id)?P("",!0):(p(),L("div",Oe,[i(n,{size:"24",color:"grey"},{default:l(()=>[...e[4]||(e[4]=[x("mdi-lock",-1)])]),_:1}),a("span",null,"Unlocks at Level "+h(t.getUnlockLevel(f.difficulty_score)),1)])),a("div",De,[a("div",Ge,[i(n,null,{default:l(()=>[x(h(f.icon),1)]),_:2},1024)]),a("div",Ie,[a("h4",null,h(f.name),1),a("div",Ke,[a("span",null,"Difficulty: "+h(f.difficulty_score),1),t.isUnlocked(f.id)?(p(),C(n,{key:0,size:"12",color:"success"},{default:l(()=>[...e[5]||(e[5]=[x(" mdi-check-circle ",-1)])]),_:1})):P("",!0)])])]),a("p",qe,h(f.description),1),a("div",Xe,[e[6]||(e[6]=a("span",{class:"example-label"},"Example",-1)),a("code",null,"/"+h(f.example)+"/g",1),a("p",null,h(f.explanation),1)])]),_:2},1032,["class"]))),128))]),i(r,{type:"info",variant:"tonal",class:"mt-6"},{default:l(()=>[...e[7]||(e[7]=[a("strong",null,"Tip:",-1),x(" As you progress through levels, more advanced regex features will unlock automatically. Practice with simpler patterns first! ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}const Ye=A(Ne,[["render",We]]),He=[{key:"quotable",url:"https://api.quotable.io/random?minLength=100&maxLength=300",parser:c=>c.content},{key:"uselessfacts",url:"https://uselessfacts.jsph.pl/api/v2/facts/random",parser:c=>c.text},{key:"chucknorris",url:"https://api.chucknorris.io/jokes/random",parser:c=>c.value},{key:"adviceslip",url:"https://api.adviceslip.com/advice",parser:c=>c.slip.advice},{key:"catfact",url:"https://catfact.ninja/fact",parser:c=>c.fact},{key:"jokes",url:"https://official-joke-api.appspot.com/random_joke",parser:c=>`${c.setup} ${c.punchline}`}],X="The quick brown fox jumps over the lazy dog. Programming is the art of telling a computer what to do. Numbers like 123 and 456 are important. Characters repeat sometimes, like ooooh or ahhhh!",Je=Z("text",()=>{const c=B("regex-game-text",""),e=B("regex-game-targets",[]),s=B("regex-game-features",[]),t=E(!1),g=B("regex-game-cache",{}),v=B("regex-game-seen",[]),n=V({get:()=>g.value,set:k=>{const y={...g.value};for(const[b,S]of Object.entries(k)){const T=y[b]||[];y[b]=[...new Set([...T,...S])]}g.value=y}}),d=V(()=>Object.values(g.value).flat()),u=V(()=>{const k=new Set(v.value);return d.value.filter(y=>!k.has(y))}),o=V(()=>d.value.length>0&&u.value.length===0);function r(){c.value&&!v.value.includes(c.value)&&(v.value=[...new Set([...v.value,c.value])])}function _(k,y){!y||y.length<50||(n.value={[k]:[y]})}function w(){return u.value.length===0?null:u.value[Math.floor(Math.random()*u.value.length)]}async function f(k){const b=await(await fetch(k.url)).json(),S=k.parser(b);return{key:k.key,text:S}}function F(k,y){const b=ae(k,y,3);return b?(c.value=k,e.value=b.targets,s.value=b.features,!0):!1}async function D(k){t.value=!0;const y=w();if(y&&F(y,k)){t.value=!1;return}o.value&&(v.value=[]);const b=He.map(S=>f(S).then(T=>(_(T.key,T.text),T)).catch(()=>null));try{const S=await Promise.race(b.map(T=>T.then(R=>{if(R&&R.text&&R.text.length>=50)return R;throw new Error("Invalid text")})));if(S&&F(S.text,k)){t.value=!1,Promise.allSettled(b);return}}catch{const S=w();if(S&&F(S,k)){t.value=!1;return}}F(X,k)||(c.value=X,e.value=[{text:"qui",feature:"literal",featureName:"Literal Characters"},{text:"fox",feature:"literal",featureName:"Literal Characters"},{text:"art",feature:"literal",featureName:"Literal Characters"}],s.value=[]),t.value=!1}return{text:c,targets:e,currentFeatures:s,isLoading:t,textCache:n,markText:r,getText:D}}),Qe=M({__name:"game",setup(c,{expose:e}){e();const s=Je(),{text:t,targets:g,currentFeatures:v,isLoading:n}=$(s),d=E(1),u=E(0),o=E(0),r=E(""),_=E(!1),w=E(0),f=E(!1),F=async()=>{r.value="",await s.getText(d.value)},D=V(()=>{if(!r.value||!t.value)return[];try{const j=new RegExp(r.value,"g"),z=[];let U;for(;(U=j.exec(t.value))!==null&&(z.push({start:U.index,end:U.index+U[0].length,text:U[0]}),U[0].length!==0););return g.value.map((N,Y)=>z.some(I=>ne(I.text,N.text)||N.start!==void 0&&N.end!==void 0&&I.start<=N.start&&I.end>=N.end)?Y:-1).filter(N=>N!==-1)}catch{return[]}}),k=V(()=>{if(!r.value||!t.value)return 0;try{const j=new RegExp(r.value,"g"),z=t.value.match(j);return z?z.length:0}catch{return 0}}),y=V(()=>D.value.length===g.value.length&&g.value.length>0);K(y,j=>{window.dispatchEvent(new CustomEvent("game:state",{detail:{isAllMatched:j}}))});const b=()=>{if(y.value){const j=100*d.value,z=o.value*25,U=j+z;w.value=U,u.value+=U,o.value++,s.markText(),_.value=!0}},S=()=>{_.value=!1,d.value++,F()},T=()=>{o.value=0,F()},R=()=>{f.value=!0};J(()=>{F(),window.addEventListener("game:skip",T),window.addEventListener("game:next",b),window.addEventListener("game:show-guide",R)}),Q(()=>{window.removeEventListener("game:skip",T),window.removeEventListener("game:next",b),window.removeEventListener("game:show-guide",R)});const q={textStore:s,text:t,targets:g,currentFeatures:v,isLoading:n,level:d,score:u,streak:o,regex:r,showSuccess:_,pointsEarned:w,showLegend:f,getText:F,matchedTargets:D,matchCount:k,isAllMatched:y,handleSubmit:b,handleNextLevel:S,handleSkip:T,handleShowGuide:R,GameBoard:ce,TargetDisplay:fe,LevelIndicator:Se,SuccessModal:ze,RegexLegend:Ye};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),Ze={class:"game-page"},$e={class:"game-container"},et={class:"game-header"},tt={key:0,class:"loading-state"},st={key:1,class:"game-content"},at={class:"flex items-center gap-3 mb-3 font-medium"},nt={class:"flex flex-wrap gap-2 mb-2"};function lt(c,e,s,t,g,v){const n=m("v-progress-circular"),d=m("v-icon"),u=m("v-chip"),o=m("v-card-text"),r=m("v-card-info");return p(),L("div",Ze,[e[7]||(e[7]=a("div",{class:"peek-container"},[a("span",{class:"peek-title sigmar-ff"},"run-regex-run")],-1)),a("div",$e,[a("div",et,[i(t.LevelIndicator,{level:t.level,score:t.score},null,8,["level","score"])]),t.isLoading?(p(),L("div",tt,[i(n,{indeterminate:"",color:"cyan",size:"40"}),e[3]||(e[3]=a("p",null,"Loading challenge...",-1))])):(p(),L("div",st,[i(t.GameBoard,{text:t.text,regex:t.regex,targets:t.targets},null,8,["text","regex","targets"]),i(t.TargetDisplay,{modelValue:t.regex,"onUpdate:modelValue":e[0]||(e[0]=_=>t.regex=_),targets:t.targets,"matched-targets":t.matchedTargets,"is-valid":t.isAllMatched,"match-count":t.matchCount,streak:t.streak,onSubmit:t.handleSubmit},null,8,["modelValue","targets","matched-targets","is-valid","match-count","streak"]),t.currentFeatures.length>0?(p(),C(r,{key:0},{default:l(()=>[i(o,null,{default:l(()=>[a("div",at,[i(d,{size:"20",color:"secondary"},{default:l(()=>[...e[4]||(e[4]=[x("mdi-lightbulb-on",-1)])]),_:1}),e[5]||(e[5]=a("span",{class:"text-purple-200"},"Features for this level",-1))]),a("div",nt,[(p(!0),L(O,null,G(t.currentFeatures,(_,w)=>(p(),C(u,{key:w},{default:l(()=>[i(d,{size:"14",class:"mr-1"},{default:l(()=>[x(h(_.icon),1)]),_:2},1024),x(" "+h(_.name),1)]),_:2},1024))),128))]),e[6]||(e[6]=a("p",{class:"text-xs text-purple-200/70 m-0"},"Try using these patterns to match all targets",-1))]),_:1})]),_:1})):P("",!0)]))]),i(t.SuccessModal,{modelValue:t.showSuccess,"onUpdate:modelValue":e[1]||(e[1]=_=>t.showSuccess=_),level:t.level,score:t.score,"points-earned":t.pointsEarned,onNextLevel:t.handleNextLevel},null,8,["modelValue","level","score","points-earned"]),i(t.RegexLegend,{modelValue:t.showLegend,"onUpdate:modelValue":e[2]||(e[2]=_=>t.showLegend=_),"current-level":t.level},null,8,["modelValue","current-level"])])}const _t=A(Qe,[["render",lt]]);export{_t as default};
